name: customer-success-fte-stage1
version: "1.0"
description: >
  Stage 1 incubation skills for the Customer Success Digital FTE.
  These skills define the reusable capabilities discovered and prototyped
  during the incubation phase (Exercises 1.1-1.5).

skills:
  - id: knowledge_retrieval
    name: Knowledge Retrieval
    trigger: Customer asks product questions
    inputs:
      - name: query
        type: str
        description: Customer question or search text
    outputs:
      - name: results
        type: list
        description: Relevant documentation snippets (max 5)
    tool: search_knowledge_base
    notes: >
      Searches product-docs.md and resolved ticket history.
      Returns ranked snippets. Falls back to escalation if no results after 2 attempts.

  - id: sentiment_analysis
    name: Sentiment Analysis
    trigger: Every incoming customer message
    inputs:
      - name: message
        type: str
        description: Raw customer message text
    outputs:
      - name: sentiment_score
        type: float
        description: Score from 0.0 (very negative) to 1.0 (very positive)
      - name: confidence
        type: float
        description: Confidence in the sentiment assessment
    notes: >
      Stage 1 uses heuristic keyword matching. Stage 2 will use LLM-based scoring.
      Escalation triggered when sentiment < 0.3.

  - id: escalation_decision
    name: Escalation Decision
    trigger: After generating response, before sending
    inputs:
      - name: conversation_context
        type: dict
        description: Full conversation history and metadata
      - name: sentiment_trend
        type: list
        description: Recent sentiment scores for the customer
      - name: category
        type: str
        description: Detected ticket category (general, technical, billing)
    outputs:
      - name: should_escalate
        type: bool
        description: Whether to escalate to human agent
      - name: reason
        type: str
        description: Escalation reason code (pricing_inquiry, refund_request, legal_compliance, hostile_sentiment, security_incident, human_requested, critical_workflow_blocked)
    notes: >
      Rules aligned to context/escalation-rules.md.
      Triggers include: pricing, refunds, legal/compliance, sentiment < 0.3,
      security incidents, explicit human request, critical workflow blocks.

  - id: channel_adaptation
    name: Channel Adaptation
    trigger: Before sending any response
    inputs:
      - name: response_text
        type: str
        description: Raw agent response
      - name: target_channel
        type: str
        enum: [email, whatsapp, web_form]
        description: Channel to format for
    outputs:
      - name: formatted_response
        type: str
        description: Response formatted per channel constraints
    constraints:
      email:
        style: Formal, detailed
        max_length: 500 words
        includes: greeting, signature
      whatsapp:
        style: Conversational, concise
        max_length: 300 characters preferred
        includes: quick triage, short next step
      web_form:
        style: Semi-formal, structured
        max_length: 300 words
        includes: checklist-style steps
    notes: >
      Templates defined in specs/channel-response-templates.md.

  - id: customer_identification
    name: Customer Identification
    trigger: On every incoming message
    inputs:
      - name: message_metadata
        type: dict
        description: "Metadata including email, phone, form submission ID"
    outputs:
      - name: customer_id
        type: str
        description: Unified customer identifier (email as primary key)
      - name: merged_history
        type: list
        description: Past interactions across all channels
    notes: >
      Uses email address as primary identifier. Phone number as secondary.
      Cross-channel identification target: >95% accuracy.

mcp_tools:
  - search_knowledge_base
  - create_ticket
  - get_customer_history
  - escalate_to_human
  - send_response

references:
  - specs/customer-success-fte-spec.md
  - specs/discovery-log.md
  - specs/channel-response-templates.md
  - context/escalation-rules.md
  - context/product-docs.md
